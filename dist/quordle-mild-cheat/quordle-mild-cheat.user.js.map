{
  "version": 3,
  "sources": ["../../src/main/quordle-mild-cheat/quordle-mild-cheat.user.ts"],
  "sourcesContent": ["// ==UserScript==\n// @name         Quordle Mild Cheat\n// @namespace    https://github.com/bricemciver/\n// @version      0.1\n// @license      MIT\n// @description  Get hints based on the words you've already tried\n// @author       bricemciver\n// @match        https://www.merriam-webster.com/games/quordle/*\n// @icon         https://www.google.com/s2/favicons?sz=64&domain=merriam-webster.com\n// @grant        GM.xmlHttpRequest\n// @grant        GM_xmlhttpRequest\n// ==/UserScript==\n\ntype ProcessedCell = {\n  letter: string;\n  position: number;\n  status: 'diff' | 'correct' | 'none';\n};\n\nconst wordBankRegEx = /wordBank:\\s*\"([^\"]*)\"/;\nconst allowedRegEx = /allowed:\\s*\"([^\"]*)\"/;\nconst wordBankWords: string[] = [];\nconst allowedWords: string[] = [];\n\n/**\n * Set an item into storage\n * @param key key to set\n * @param value value to set\n */\nconst setItem = (key: string, value: any) => {\n  window.sessionStorage.setItem(key, JSON.stringify(value));\n};\n\n/**\n * Get an item from session storage\n * @param key key to get\n * @param defaultVal value to return if key doesn't exist\n */\nconst getItem = (key: string, defaultVal: any) => {\n  const val = window.sessionStorage.getItem(key);\n  if (!val || val === 'undefined') return defaultVal;\n  try {\n    return JSON.parse(val);\n  } catch (e) {\n    return val;\n  }\n};\n\nconst findAllowedWords = () => {\n  // see if we need to retrieve\n  wordBankWords.push(...getItem('wordBank', []));\n  allowedWords.push(...getItem('allowed', []));\n  if (!wordBankWords.length || !allowedWords.length) {\n    const script = document.querySelector<HTMLScriptElement>(\"script[type='module']\");\n\n    // Get the script\n    if (script) {\n      GM.xmlHttpRequest({\n        method: 'GET',\n        url: script.src,\n        onload(response) {\n          const text = response.responseText;\n          // get wordBank words\n          const wordBankMatches = RegExp(wordBankRegEx).exec(text);\n          if (wordBankMatches && wordBankMatches.length > 1) {\n            wordBankWords.push(...wordBankMatches[1].split(' '));\n          }\n          // get allowed words\n          const allowedMatches = RegExp(allowedRegEx).exec(text);\n          if (allowedMatches && allowedMatches.length > 1) {\n            allowedWords.push(...allowedMatches[1].split(' '));\n          }\n          // store in session so we don't retrieve every time\n          setItem('wordBank', wordBankWords);\n          setItem('allowed', allowedWords);\n        },\n      });\n    }\n  }\n};\n\nconst createWordlistDialog = () => {\n  const wordlist = document.createElement('dialog');\n  wordlist.classList.add('dialog');\n  wordlist.id = 'dialog';\n  const header = document.createElement('h2');\n  header.textContent = 'Word List';\n  wordlist.appendChild(header);\n  const listContainer = document.createElement('div');\n  listContainer.id = 'wordList';\n  wordlist.appendChild(listContainer);\n  return wordlist;\n};\n\nconst createBoardList = (wordList: HTMLElement, board: string[], title: string) => {\n  const boardHeader = document.createElement('h2');\n  boardHeader.textContent = title;\n  wordList.appendChild(boardHeader);\n  const list = document.createElement('ul');\n  board.forEach(word => {\n    const listItem = document.createElement('li');\n    listItem.textContent = word;\n    if (wordBankWords.some(item => item === word)) {\n      listItem.classList.add('font-bold');\n    }\n    list.appendChild(listItem);\n  });\n  wordList.appendChild(list);\n};\n\nconst showWordlist = (...boards: string[][]) => {\n  let wordList = document.getElementById('wordList');\n  if (!wordList) {\n    // load new styles\n    const head = document.getElementsByTagName('head')[0];\n    const style = document.createElement('style');\n    head.appendChild(style);\n    style.setAttribute('type', 'text/css');\n    if (style.sheet) {\n      style.sheet.insertRule(`.dialog li {\n            display: block;\n            padding: 2px 0px;\n        }`);\n      style.sheet.insertRule(`.dialog ul {\n            list-style: none;\n            margin: 4px 0px;\n            position: relative;\n            padding: 0px;\n        }`);\n      style.sheet.insertRule(`.dialog h2 {\n            font-size: 0.6875rem;\n            line-height: 1.5;\n            letter-spacing: 0.08rem;\n            font-family: \"IBM Plex Sans\", -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n            font-weight: 700;\n            display: flex;\n            align-items: center;\n            border-radius: 5px;\n            outline: 0px;\n            width: 100%;\n            justify-content: flex-start;\n            transition: color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms, background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n            text-decoration: none;\n            color: rgb(111, 126, 140);\n            margin-top: 8px;\n            text-transform: uppercase;\n        }`);\n      style.sheet.insertRule(`.dialog {\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            width: 300px;\n            padding: 20px;\n            background-color: #f2f2f2;\n            border: 1px solid #ccc;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n            font-family: Arial, sans-serif;\n            color: #333;\n            margin: 0 auto;\n        }`);\n    }\n\n    // create wordlist div\n    const helpDiv = createWordlistDialog();\n\n    // attach to body\n    document.body.appendChild(helpDiv);\n    wordList = document.getElementById('wordList');\n  }\n\n  if (wordList) {\n    wordList.innerHTML = '';\n  }\n\n  // add boards\n  boards.forEach((board, index) => {\n    if (wordList) {\n      createBoardList(wordList, board, `Board ${index + 1}`);\n    }\n  });\n\n  const dialog = document.querySelector<HTMLDialogElement>('dialog#dialog');\n  if (dialog) {\n    dialog.showModal();\n  }\n};\n\nconst hideWordlist = () => {\n  const dialog = document.querySelector<HTMLDialogElement>('dialog#dialog');\n  if (dialog) {\n    dialog.close();\n  }\n};\n\nconst addListeners = () => {\n  document.addEventListener(\n    'keydown',\n    function (event) {\n      if (event.defaultPrevented) {\n        return; // Do nothing if the event was already processed\n      }\n      if (event.key === '?') {\n        event.preventDefault();\n        const boardArray: string[][] = [];\n        for (let i = 1; i < 5; i++) {\n          boardArray.push(processGameBoard(extractGameBoard(i)));\n        }\n        showWordlist(...boardArray);\n      }\n      if (event.key === 'Escape') {\n        event.preventDefault();\n        hideWordlist();\n      }\n    },\n    true,\n  );\n};\n\n/**\n * Examples of text found:\n * - 'A' (letter 1) is in a different spot\n * - 'S' (letter 1) is correct\n * - 'N' (letter 3) is incorrect\n */\nconst cellRegEx = /'(\\w+)' \\(letter (\\d+)\\) is (in a different spot|correct|incorrect)/;\nconst processCell = (element: HTMLDivElement): ProcessedCell | null => {\n  const label = element.ariaLabel;\n  if (label) {\n    const match = RegExp(cellRegEx).exec(label);\n    if (match && match.length > 3) {\n      const letter = match[1];\n      const position = parseInt(match[2], 10);\n      const status = match[3];\n      return {\n        letter,\n        position,\n        status: statusToBasic[status],\n      };\n    }\n  }\n  return null;\n};\n\nconst statusToBasic: Record<string, 'diff' | 'correct' | 'none'> = {\n  'in a different spot': 'diff',\n  correct: 'correct',\n  incorrect: 'none',\n};\n\nconst extractGameBoard = (boardNum: number) => {\n  const boardState: ProcessedCell[] = [];\n  const board = document.querySelector<HTMLDivElement>(`div[role=\"table\"][aria-label=\"Game Board ${boardNum}\"]`);\n  // get rows\n  if (board) {\n    const rows = board.querySelectorAll<HTMLDivElement>('div[role=\"row\"]');\n    rows.forEach(row => {\n      // get all cells in a row\n      const cells = row.querySelectorAll<HTMLDivElement>('div[role=\"cell\"]');\n      cells.forEach(cell => {\n        // get the letter, position, and status\n        const processedCell = processCell(cell);\n        if (processedCell !== null) {\n          boardState.push(processedCell);\n        }\n      });\n    });\n  }\n  return boardState;\n};\n\nconst sortProcessedCells = (cells: ProcessedCell[]): ProcessedCell[] => {\n  const statusOrder: Record<string, number> = {\n    correct: 0,\n    diff: 1,\n    none: 2,\n  };\n\n  return cells.sort((a, b) => statusOrder[a.status] - statusOrder[b.status]);\n};\n\nconst processGameBoard = (boardState: ProcessedCell[]) => {\n  let tempWordList: string[] = [...wordBankWords, ...allowedWords];\n\n  // sort boardState so all correct answers are handled first, then diff, then none\n  sortProcessedCells(boardState);\n\n  boardState.forEach(item => {\n    if (item.status === 'correct') {\n      // process all the correct answers first to shrink word list\n      tempWordList = tempWordList.filter(word => word.charAt(item.position - 1).toUpperCase() === item.letter.toUpperCase());\n    } else if (item.status === 'diff') {\n      // now eliminate words where 'diff' items appear in that spot\n      // and where 'diff' item doesn't appear at all\n      tempWordList = tempWordList.filter(\n        word =>\n          word.charAt(item.position - 1).toUpperCase() !== item.letter.toUpperCase() && word.indexOf(item.letter.toUpperCase()) !== -1,\n      );\n    } else if (\n      item.status === 'none' &&\n      !boardState.some(({ letter, status }) => (status === 'correct' || status === 'diff') && letter === item.letter)\n    ) {\n      // need to be careful here, only remove 'none' if it wasn't previously 'correct' or 'diff' (since it could be a second occurance)\n      tempWordList = tempWordList.filter(word => word.indexOf(item.letter.toUpperCase()) === -1);\n    } else if (\n      item.status === 'none' &&\n      boardState.some(({ letter, status }) => (status === 'correct' || status === 'diff') && letter === item.letter)\n    ) {\n      // edge case; remove words with duplicate letters if status is none but other status of diff or correct exists\n      // this will not handle words with 3 of the same letter correctly\n      tempWordList = tempWordList.filter(word => word.indexOf(item.letter.toUpperCase()) === word.lastIndexOf(item.letter.toUpperCase()));\n    }\n  });\n\n  return tempWordList;\n};\n\n// Retrieve (locally or from site) the word lists\nfindAllowedWords();\n\n// add listeners\naddListeners();\n"],
  "mappings": "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",
  "names": []
}
