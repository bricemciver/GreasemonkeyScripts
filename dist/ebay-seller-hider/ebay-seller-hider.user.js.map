{
  "version": 3,
  "sources": ["../../src/main/ebay-seller-hider/ebay-seller-hider.user.ts"],
  "sourcesContent": ["// ==UserScript==\n// @name         eBay Seller Hider\n// @namespace    bricemciver\n// @description  Hide items from low/poor feedback eBay sellers and sponsored items\n// @author       Brice McIver\n// @license      MIT\n// @version      0.0.5\n// @match        *://*.ebay.com/*\n// @icon         https://www.google.com/s2/favicons?sz=64&domain=ebay.com\n// ==/UserScript==\n\nlet filterReviews = true;\nlet reviewMin = 10;\nlet filterFeedback = true;\nlet feedbackMin = 95.0;\nlet hideSponsored = true;\nlet sponsorClass = '';\n\nconst hideItem = (seller: HTMLElement): void => {\n  const itemRegExp = RegExp(/\\((.*)\\) (.*)%/).exec(seller.innerText);\n  if (itemRegExp) {\n    const [, reviews, feedback] = itemRegExp;\n\n    const reviewsNum = parseInt(reviews.replace(',', ''), 10);\n    const feedbackNum = parseFloat(feedback);\n    let parent = seller.parentElement;\n    while (parent && parent.tagName !== 'LI') {\n      parent = parent.parentElement;\n    }\n    if (parent) {\n      parent.style.display =\n        (filterReviews && reviewsNum < reviewMin) || (filterFeedback && feedbackNum < feedbackMin) ? 'none' : 'list-item';\n      // don't bother looking for sponsored posts if already hidden\n      if (hideSponsored && parent.style.display === 'list-item') {\n        let hideSponsoredPost = false;\n        const sponsoredSpan = Array.from(parent.querySelectorAll('span')).find(item => item.textContent === 'Sponsored');\n        if (sponsoredSpan) {\n          const labelAttr = sponsoredSpan.parentElement?.parentElement?.getAttribute('aria-labelledBy');\n          if (labelAttr && labelAttr === sponsorClass) {\n            hideSponsoredPost = true;\n          }\n        }\n        parent.style.display = hideSponsoredPost ? 'none' : 'list-item';\n      }\n    }\n  }\n};\n\nconst createHeader = (): HTMLDivElement => {\n  const header = document.createElement('div');\n  const headerTitle = document.createElement('h3');\n  headerTitle.classList.add('x-refine__item');\n  headerTitle.textContent = 'Sellers';\n  header.append(headerTitle);\n  return header;\n};\n\nconst createCheckboxEventListener = (valueName: string, checkbox: HTMLInputElement): void => {\n  if (valueName === 'reviewMin') {\n    localStorage.setItem('filterReviews', checkbox.checked ? 'true' : 'false');\n    updateFilter();\n  }\n  if (valueName === 'feedbackMin') {\n    localStorage.setItem('filterFeedback', checkbox.checked ? 'true' : 'false');\n    updateFilter();\n  }\n  if (valueName === 'hideSponsored') {\n    localStorage.setItem('hideSponsored', checkbox.checked ? 'true' : 'false');\n    updateFilter();\n  }\n};\n\nconst createCheckbox = (text: string, valueName: string): HTMLInputElement => {\n  const checkbox = document.createElement('input');\n  checkbox.type = 'checkbox';\n  checkbox.ariaLabel = text;\n  checkbox.classList.add('cbx', 'x-refine__multi-select-checkbox');\n  checkbox.autocomplete = 'off';\n  checkbox.ariaHidden = 'true';\n  checkbox.tabIndex = -1;\n  checkbox.role = 'presentation';\n  if (\n    (valueName === 'reviewMin' && filterReviews) ||\n    (valueName === 'feedbackMin' && filterFeedback) ||\n    (valueName === 'hideSponsored' && hideSponsored)\n  ) {\n    checkbox.setAttribute('checked', 'true');\n  }\n  checkbox.addEventListener('input', () => createCheckboxEventListener(valueName, checkbox));\n  return checkbox;\n};\n\nconst createListItem = (text: string, valueName: string, value?: string): HTMLLIElement => {\n  const listItem = document.createElement('li');\n  listItem.classList.add('x-refine__main__list--value');\n  const selectItem = document.createElement('div');\n  selectItem.classList.add('x-refine__multi-select');\n  const checkbox = createCheckbox(text, valueName);\n  const checkboxText = document.createElement('span');\n  checkboxText.classList.add('cbx', 'x-refine__multi-select-cbx');\n  checkboxText.innerText = text;\n  if (value) {\n    const input = document.createElement('input');\n    input.type = 'text';\n    input.pattern = 'd*';\n    input.value = value;\n    input.addEventListener('change', evt => {\n      const target = evt.target as HTMLInputElement | null;\n      if (target) {\n        localStorage.setItem(valueName, target.value);\n        updateFilter();\n      }\n    });\n    input.style.height = '22px';\n    input.style.width = '50px';\n    input.style.margin = '-3px 0 0 8px';\n    input.style.padding = '3px';\n    input.style.float = 'right';\n    input.style.fontSize = '11px';\n\n    checkboxText.append(input);\n  }\n  selectItem.append(checkbox);\n  selectItem.append(checkboxText);\n  listItem.append(selectItem);\n  return listItem;\n};\n\nconst createGroup = (): HTMLDivElement => {\n  const group = document.createElement('div');\n  group.classList.add('x-refine__group');\n  const listHeader = document.createElement('ul');\n  listHeader.classList.add('x-refine__main__value');\n  listHeader.style.clear = 'both';\n  listHeader.append(createListItem('# of Reviews over ', 'reviewMin', reviewMin.toString()));\n  listHeader.append(createListItem('Feedback over ', 'feedbackMin', feedbackMin.toString()));\n  listHeader.append(createListItem('Hide sponsored', 'hideSponsored'));\n  group.append(listHeader);\n  return group;\n};\n\nconst getPresets = (): void => {\n  filterReviews = localStorage.getItem('filterReviews') !== 'false';\n  reviewMin = parseInt(localStorage.getItem('reviewMin') ?? '10', 10);\n  filterFeedback = localStorage.getItem('filterFeedback') !== 'false';\n  feedbackMin = parseFloat(localStorage.getItem('feedbackMin') ?? '95.0');\n  hideSponsored = localStorage.getItem('hideSponsored') !== 'false';\n};\n\nconst addFilter = (): void => {\n  const menu = document.querySelector('.x-refine__left__nav');\n  if (menu) {\n    const list = document.createElement('li');\n    list.classList.add('x-refine__main__list');\n    list.append(createHeader());\n    list.append(createGroup());\n    menu.prepend(list);\n  }\n};\n\nconst updateFilter = (): void => {\n  getPresets();\n  const sellers = document.querySelectorAll('span.s-item__seller-info-text');\n  for (const seller of Array.from(sellers)) {\n    hideItem(seller as HTMLElement);\n  }\n};\n\nconst findSponsoredClass = (): void => {\n  // get inserted style\n  const styleBlock = Array.from(document.head.getElementsByTagName('style')).find(item => item.type === 'text/css');\n  if (styleBlock) {\n    const cssRuleList = styleBlock.sheet?.cssRules;\n    if (cssRuleList) {\n      const rule = Array.from(cssRuleList).find(item => item.cssText.includes('inline') && item.cssText.includes('span.'));\n      if (rule) {\n        const regex = /\\.([a-zA-Z0-9_-]+)\\s*\\{/;\n        const match = regex.exec(rule.cssText);\n        if (match) {\n          sponsorClass = match[1];\n        }\n      }\n    }\n  }\n};\n\ngetPresets();\naddFilter();\nupdateFilter();\nfindSponsoredClass();\n"],
  "mappings": "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",
  "names": []
}
