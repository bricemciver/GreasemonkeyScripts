{
  "version": 3,
  "sources": ["../../src/main/kinja-deals-keyboard-navigation/kinja-deals-keyboard-navigation.user.ts"],
  "sourcesContent": ["const headTags: Element[] = [];\nlet pos = -1;\n\nconst addGlobalStyle = (css: string): void => {\n  const head = document.getElementsByTagName('head')[0];\n  const style = document.createElement('style');\n  style.innerHTML = css;\n  head.appendChild(style);\n};\n\nconst keyPressed = (event: KeyboardEvent): void => {\n  if (event.code === 'KeyK' || event.code === 'KeyJ') {\n    if (headTags[pos]) {\n      headTags[pos].className = headTags[pos].className.replace(' selected', '');\n    }\n    if ('KeyK' === event.code) {\n      pos--;\n    }\n    if ('KeyJ' === event.code) {\n      pos++;\n    }\n    // wrap around\n    if (pos >= headTags.length) {\n      pos = 0;\n    }\n    if (pos < 0) {\n      pos = headTags.length - 1;\n    }\n    headTags[pos].className = headTags[pos].className + ' selected';\n    headTags[pos].scrollIntoView();\n  }\n};\n\nconst removeCruft = (): void => {\n  document.querySelectorAll('.js_movable_ad_slot').forEach(element => element.remove());\n  document.querySelectorAll('.connatix-container').forEach(element => element.remove());\n  Array.from(document.getElementsByTagName('span'))\n    .filter(item => item.textContent === 'G/O Media may get a commission')\n    .forEach(element => element.closest('aside')?.remove());\n  document.querySelectorAll('#sidebar_wrapper').forEach(element => element.closest('aside')?.remove());\n};\n\nconst createEntries = (containerDiv: Element): void => {\n  let newElement: Element | null = null;\n  Array.from(containerDiv.children).forEach(element => {\n    // this is the beginning or end or a section\n    if (element.tagName === 'H2' && element.textContent?.length && element.textContent.length > 0) {\n      newElement = document.createElement('div');\n      newElement.className = 'inlineFrame';\n      element.insertAdjacentElement('beforebegin', newElement);\n      newElement.append(element);\n    } else if (newElement) {\n      newElement.append(element);\n    }\n  });\n};\n\nconst addListeners = (containerDiv: Element): void => {\n  // get all section headers\n  headTags.push(containerDiv);\n  headTags.push(...Array.from(containerDiv.querySelectorAll('div.inlineFrame, h3, h4')));\n  document.addEventListener('keydown', keyPressed);\n};\n\n// remove unneeded content\nremoveCruft();\n\n// find main content\nconst mainDiv = document.querySelector('.js_post-content .js_commerce-inset-grid');\nif (mainDiv) {\n  // add necessary styles\n  addGlobalStyle(\n    'div.inlineFrame { margin-top:17px; margin-bottom:17px; padding:33px; border-radius:3px; border: 1px solid rgba(0,0,0,0.05) }',\n  );\n  addGlobalStyle('div.inlineFrame.selected { border: 1px solid rgba(0, 0, 0, 0.15) }');\n  addGlobalStyle('main { width:100% !important }');\n\n  if (mainDiv.parentElement) {\n    // create entries\n    createEntries(mainDiv.parentElement);\n\n    // add keyboard navigation\n    addListeners(mainDiv.parentElement);\n  }\n}\n"],
  "mappings": ";;;AAAA,MAAM,WAAsB,CAAC;AAC7B,MAAI,MAAM;AAEV,MAAM,iBAAiB,CAAC,QAAsB;AAC5C,UAAM,OAAO,SAAS,qBAAqB,MAAM,EAAE,CAAC;AACpD,UAAM,QAAQ,SAAS,cAAc,OAAO;AAC5C,UAAM,YAAY;AAClB,SAAK,YAAY,KAAK;AAAA,EACxB;AAEA,MAAM,aAAa,CAAC,UAA+B;AACjD,QAAI,MAAM,SAAS,UAAU,MAAM,SAAS,QAAQ;AAClD,UAAI,SAAS,GAAG,GAAG;AACjB,iBAAS,GAAG,EAAE,YAAY,SAAS,GAAG,EAAE,UAAU,QAAQ,aAAa,EAAE;AAAA,MAC3E;AACA,UAAI,WAAW,MAAM,MAAM;AACzB;AAAA,MACF;AACA,UAAI,WAAW,MAAM,MAAM;AACzB;AAAA,MACF;AAEA,UAAI,OAAO,SAAS,QAAQ;AAC1B,cAAM;AAAA,MACR;AACA,UAAI,MAAM,GAAG;AACX,cAAM,SAAS,SAAS;AAAA,MAC1B;AACA,eAAS,GAAG,EAAE,YAAY,SAAS,GAAG,EAAE,YAAY;AACpD,eAAS,GAAG,EAAE,eAAe;AAAA,IAC/B;AAAA,EACF;AAEA,MAAM,cAAc,MAAY;AAC9B,aAAS,iBAAiB,qBAAqB,EAAE,QAAQ,aAAW,QAAQ,OAAO,CAAC;AACpF,aAAS,iBAAiB,qBAAqB,EAAE,QAAQ,aAAW,QAAQ,OAAO,CAAC;AACpF,UAAM,KAAK,SAAS,qBAAqB,MAAM,CAAC,EAC7C,OAAO,UAAQ,KAAK,gBAAgB,gCAAgC,EACpE,QAAQ,aAAW,QAAQ,QAAQ,OAAO,GAAG,OAAO,CAAC;AACxD,aAAS,iBAAiB,kBAAkB,EAAE,QAAQ,aAAW,QAAQ,QAAQ,OAAO,GAAG,OAAO,CAAC;AAAA,EACrG;AAEA,MAAM,gBAAgB,CAAC,iBAAgC;AACrD,QAAI,aAA6B;AACjC,UAAM,KAAK,aAAa,QAAQ,EAAE,QAAQ,aAAW;AAEnD,UAAI,QAAQ,YAAY,QAAQ,QAAQ,aAAa,UAAU,QAAQ,YAAY,SAAS,GAAG;AAC7F,qBAAa,SAAS,cAAc,KAAK;AACzC,mBAAW,YAAY;AACvB,gBAAQ,sBAAsB,eAAe,UAAU;AACvD,mBAAW,OAAO,OAAO;AAAA,MAC3B,WAAW,YAAY;AACrB,mBAAW,OAAO,OAAO;AAAA,MAC3B;AAAA,IACF,CAAC;AAAA,EACH;AAEA,MAAM,eAAe,CAAC,iBAAgC;AAEpD,aAAS,KAAK,YAAY;AAC1B,aAAS,KAAK,GAAG,MAAM,KAAK,aAAa,iBAAiB,yBAAyB,CAAC,CAAC;AACrF,aAAS,iBAAiB,WAAW,UAAU;AAAA,EACjD;AAGA,cAAY;AAGZ,MAAM,UAAU,SAAS,cAAc,0CAA0C;AACjF,MAAI,SAAS;AAEX;AAAA,MACE;AAAA,IACF;AACA,mBAAe,oEAAoE;AACnF,mBAAe,gCAAgC;AAE/C,QAAI,QAAQ,eAAe;AAEzB,oBAAc,QAAQ,aAAa;AAGnC,mBAAa,QAAQ,aAAa;AAAA,IACpC;AAAA,EACF;",
  "names": []
}
