{
  "version": 3,
  "sources": ["../../src/main/equip-bid-redesign/equip-bid-redesign.user.ts"],
  "sourcesContent": ["// ==UserScript==\n// @name         Convert HTML to Bootstrap List Group Items\n// @namespace    http://tampermonkey.net/\n// @version      2024-04-17\n// @description  Converts HTML entries to Bootstrap list group items\n// @author       You\n// @match        https://www.equip-bid.com/auction/*\n// @icon         https://www.google.com/s2/favicons?sz=64&domain=equip-bid.com\n// @grant        none\n// ==/UserScript==\n\nlet currentIndex = 0;\n\nconst addFocusStyling = () => {\n  const styleEl = document.createElement('style');\n  document.head.appendChild(styleEl);\n  styleEl.sheet?.insertRule('li.list-group-item.focused{outline: Highlight auto 1px; outline:-webkit-focus-ring-color auto 1px;}');\n};\n\nconst retrieveNextPage = (href: string) => {\n  // fetch the next page\n  fetch(href)\n    .then(response => response.text())\n    .then(data => {\n      const parser = new DOMParser();\n      const doc = parser.parseFromString(data, 'text/html');\n      const entries = doc.querySelectorAll<HTMLDivElement>('div.lot-divider');\n      if (!entries.length) return;\n\n      const listGroup = document.querySelector<HTMLUListElement>('div.lot-list > ul.list-group');\n      if (!listGroup) return;\n\n      entries.forEach(entry => {\n        const listGroupItem = document.createElement('li');\n        listGroupItem.classList.add('list-group-item');\n        if (entry.previousElementSibling?.previousElementSibling?.previousElementSibling) {\n          listGroupItem.appendChild(entry.previousElementSibling?.previousElementSibling?.previousElementSibling);\n        }\n        if (entry.previousElementSibling?.previousElementSibling) {\n          listGroupItem.appendChild(entry.previousElementSibling?.previousElementSibling);\n        }\n        if (entry.previousElementSibling) {\n          listGroupItem.appendChild(entry.previousElementSibling);\n        }\n        entry.nextElementSibling?.remove();\n        entry.remove();\n        listGroup.appendChild(listGroupItem);\n      });\n\n      keyboardNavigation();\n    });\n};\n\n// Add keyboard navigation\nconst keyboardNavigation = () => {\n  const listGroup = document.querySelector<HTMLUListElement>('div.lot-list > ul.list-group');\n  if (!listGroup) return;\n\n  const listGroupItems = Array.from(listGroup.querySelectorAll<HTMLLIElement>('li.list-group-item'));\n  // get next link\n  const next = document.querySelector<HTMLAnchorElement>('li.next > a');\n\n  const handleKeyDown = (event: KeyboardEvent) => {\n    if (event.key === 'k') {\n      event.preventDefault();\n      // clear previous focused tag\n      listGroupItems[currentIndex].classList.remove('focused');\n      currentIndex = currentIndex - 1;\n      if (currentIndex < 0) {\n        currentIndex = 0;\n      } else {\n        // scroll into view\n        listGroupItems[currentIndex].scrollIntoView({ block: 'center' });\n        // focus next tag\n        listGroupItems[currentIndex].classList.add('focused');\n      }\n    }\n    if (event.key === 'j') {\n      event.preventDefault();\n      // clear previous focused tag\n      listGroupItems[currentIndex].classList.remove('focused');\n      currentIndex = currentIndex + 1;\n      if (currentIndex >= listGroupItems.length) {\n        if (next) {\n          retrieveNextPage(next.href);\n        } else {\n          currentIndex = listGroupItems.length - 1;\n        }\n      } else {\n        // scroll into view\n        listGroupItems[currentIndex].scrollIntoView({ block: 'center' });\n        // focus next tag\n        listGroupItems[currentIndex].classList.add('focused');\n      }\n    }\n  };\n\n  document.documentElement.addEventListener('keydown', handleKeyDown);\n  // scroll into view\n  listGroupItems[currentIndex].scrollIntoView({ block: 'center' });\n  // focus next tag\n  listGroupItems[currentIndex].classList.add('focused');\n};\n\nconst processEntries = () => {\n  const entries = document.querySelectorAll<HTMLDivElement>('div.lot-divider');\n  if (!entries.length) return;\n\n  const listGroup = document.createElement('ul');\n  listGroup.classList.add('list-group');\n  entries.forEach(entry => {\n    const listGroupItem = document.createElement('li');\n    listGroupItem.classList.add('list-group-item');\n    if (entry.previousElementSibling?.previousElementSibling?.previousElementSibling) {\n      listGroupItem.appendChild(entry.previousElementSibling?.previousElementSibling?.previousElementSibling);\n    }\n    if (entry.previousElementSibling?.previousElementSibling) {\n      listGroupItem.appendChild(entry.previousElementSibling?.previousElementSibling);\n    }\n    if (entry.previousElementSibling) {\n      listGroupItem.appendChild(entry.previousElementSibling);\n    }\n    entry.nextElementSibling?.remove();\n    entry.remove();\n    listGroup.appendChild(listGroupItem);\n  });\n\n  const lotList = document.querySelector<HTMLDivElement>('div.lot-list > hr');\n  if (!lotList) return;\n\n  lotList.insertAdjacentElement('afterend', listGroup);\n\n  keyboardNavigation();\n};\n\naddFocusStyling();\nprocessEntries();\n"],
  "mappings": "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",
  "names": []
}
